---
title: "ANOVA_delay"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
```

```{r include=FALSE}
delay = read.csv("./tidied_data/delay.csv") %>% 
  janitor::clean_names() 

h_weather = read.csv("./tidied_data/hourly_weather.csv") %>% 
  janitor::clean_names() 

delay = delay %>% 
  mutate(
    airline = airline_name,
    hour = scheduled_hour,
    delay = delay_minutes,
    carrierd = delay_carrier_minutes,
    extrmwd = delay_weather_minutes,
    nasd = delay_national_aviation_system_minutes,
    securityd = delay_security_minutes,
    latarrd = delay_late_aircraft_arrival_minutes) %>% 
  mutate(hour = as.numeric(hour)) %>% 
  mutate(month = month.abb[month]) %>% 
  select(airline, date, month, hour, delay, carrierd, extrmwd, nasd, securityd, latarrd)


h_weather = h_weather %>% 
  mutate(
    temperature = hourly_dry_bulb_temperature,
    humidity = hourly_relative_humidity,
    visibility = hourly_visibility,
    wind_s = hourly_wind_speed,
    hour = as.numeric(hour)) %>%
  mutate(month = month.abb[month]) %>% 
  select(date, month, hour, temperature, humidity, visibility, wind_s)

raw_df = merge(x = delay, y = h_weather, by = c("date", "month", "hour"),
               all.x = TRUE)

raw_df = raw_df %>% 
  mutate(hour_c = cut(hour, breaks = c(4, 8, 13, 17, 24),
                      labels = c("morning","noon","afternoon","night"))) %>% 
  select(-hour)
```

# ANOVA Test

In order to go more about how `month`, `airplane`, and `hour` are associated with the time of delay. We would like to do ANOVA for those categorical predictors

##  month
H0: Mean delay time are not different across months

H1: Mean delay time are different across months

```{r}
anova_delay_m = lm(delay ~ month, data = raw_df)

anova(anova_delay_m) %>% knitr::kable(caption = "One way anova of delay time and month")
```

p-value is extremely small, thus we reject the null hypothesis and conclude that mean delay times are difference across 3 different months (Nov, Dec, Jan)

## airline

H0: Mean delay time are not different across airlines

H1: Mean delay time are different across airlines

```{r}
anova_delay_a = lm(delay ~ airline, data = raw_df)

anova(anova_delay_a) %>% knitr::kable(caption = "One way anova of delay time and airline")
```

p-value is extremely small, thus we reject the null hypothesis and conclude that mean delay times are difference across 7 different airlines.

## hour_c

H0: Mean delay time are not different across hours

H1: Mean delay time are different across hours

```{r}
anova_delay_h = lm(delay ~ hour_c, data = raw_df)

anova(anova_delay_h) %>% knitr::kable(caption = "One way anova of delay time and hours")
```

p-value is extremely small, thus we reject the null hypothesis and conclude that mean delay times are difference across different hours in a day

