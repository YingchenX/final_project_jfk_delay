<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Poisson Regression</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Explore
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="explore_overview.html">Overview</a>
    </li>
    <li>
      <a href="Destination.html">Destination Airports</a>
    </li>
    <li>
      <a href="https://sn2ylh-siyue-gao.shinyapps.io/delay_cancelation/">Cancellation &amp; Delay</a>
    </li>
    <li>
      <a href="delay_interaction_c.html">Categorical Predictors</a>
    </li>
    <li>
      <a href="delay_interaction_cont.html">Continuous Predictors</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="regression_delay.html">Predictive Modeling</a>
    </li>
    <li>
      <a href="web_poisson.html">Poisson Regression</a>
    </li>
  </ul>
</li>
<li>
  <a href="project_report.html">Report</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="what_to_do_JFK.html">What to Do</a>
</li>
<li>
  <a href="about_us.html">About Us</a>
</li>
<li>
  <a href="http://">
    <span class="fa fa-brands fa-youtube fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/YingchenX/final_project_nycairport">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Poisson Regression</h1>

</div>


<p><br></p>
<p><strong>We wanted to investigate factors that were related to and
might be used to predict daily flight cancellation count. We
hypothesized that there could be daily flight cancellations due to COVID
breakouts or some specific weather conditions.</strong></p>
<p><br></p>
<div id="data-description" class="section level2">
<h2>Data Description</h2>
<p>We would like to explore the relationship between cancellation counts
and some predictors. The number of cancellations each day is therefore
regarded as the result (dependent variable), and exposures of interest
are regarded as the independent variables.</p>
<ul>
<li><code>daily_cancel</code>: daily flight cancellation counts in JFK
airport</li>
<li><code>airline_name</code>: domestic airline</li>
<li><code>year_month</code>: the date format in “Year Month”</li>
<li><code>temperature</code>: daily average dry bulb temperature
(°F)</li>
<li><code>humidity</code>: daily average relative humidity (%)</li>
<li><code>windspeed</code>: daily average relative windspeed (mph)</li>
<li><code>covid_case</code>: new daily cases of COVID-19</li>
<li><code>covid_lag6</code>: daily cases of COVID-19 with 6 days time
lag</li>
</ul>
<p><br></p>
<div id="distribution-of-daily-flight-cancellations-counts"
class="section level3">
<h3>Distribution of Daily Flight Cancellations Counts</h3>
<pre class="r"><code>cancel_tidy %&gt;% 
  ggplot(aes(x = daily_cancel, fill = &quot;rgb(255, 65, 54)&quot;)) +
  geom_histogram(alpha = .4) +
  labs(
    x = &quot;Number of Daily Flight Cancellations&quot;,
    y = &quot;Count&quot;,
    title = &quot;Distribution of Daily Flight Cancellations Counts&quot;,
    subtitle = &quot;11/1/2021 to 1/31/2022&quot;
  ) +
  scale_x_continuous(
    n.breaks = 10
  ) +
  theme(
    legend.position = &quot;none&quot;
  )</code></pre>
<p><img src="web_poisson_files/figure-html/unnamed-chunk-2-1.png" width="80%" /></p>
<p>From 11/1/2021 to 1/31/2022, the minimum number of daily
cancellations is 1, while the daily cancellations can reach up to as
high as 333.</p>
<p><br></p>
</div>
<div id="stratification-factors" class="section level3">
<h3>Stratification Factors</h3>
<p>We discovered that the cancellation count each month varied by month
and airline. Monthly flight cancellations were the highest in January
2022, followed by December and November 2021. Monthly cancellation rates
fluctuate greatly amongst airlines as well. As a result, we used the
month and the airline as stratification factors.</p>
<pre class="r"><code>cancel_airline %&gt;%
  arrange(airline_name) %&gt;% 
  pivot_wider(
  names_from = airline_name, 
  values_from = Total_number_of_cancellation) %&gt;%
  knitr::kable(
    col.names = c(&quot;Year, Month&quot;, &quot;Alaska Airlines&quot;, &quot;American Airlines&quot;, &quot;Delta Air Lines&quot;, &quot;Endeavor Air&quot;,
                  &quot;JetBlue Airways&quot;, &quot;Republic Airways&quot;, &quot;United Air Lines&quot;)) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = &quot;hover&quot;)</code></pre>
<table class="table table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Year, Month
</th>
<th style="text-align:right;">
Alaska Airlines
</th>
<th style="text-align:right;">
American Airlines
</th>
<th style="text-align:right;">
Delta Air Lines
</th>
<th style="text-align:right;">
Endeavor Air
</th>
<th style="text-align:right;">
JetBlue Airways
</th>
<th style="text-align:right;">
Republic Airways
</th>
<th style="text-align:right;">
United Air Lines
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2021-Nov
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2021-Dec
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
165
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
2022-Jan
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
182
</td>
<td style="text-align:right;">
156
</td>
<td style="text-align:right;">
416
</td>
<td style="text-align:right;">
185
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>cancel_airline %&gt;% 
  mutate(year_month = fct_relevel(year_month, &quot;2021-Nov&quot;, &quot;2021-Dec&quot;, &quot;2022-Jan&quot;)) %&gt;%
  ggplot(aes(x = year_month, y = Total_number_of_cancellation, fill = airline_name)) +
  geom_col(position = &quot;dodge&quot;, alpha = .7) +
  scale_fill_brewer(palette = &quot;Pastel1&quot;) +
  labs(
    x = &quot;&quot;,
    y = &quot;Count by Month&quot;,
    fill = &quot;Airline&quot;,
    title = &quot;Flight Cancellations by Month&quot;,
    subtitle = &quot;Nov, 2021 to Jan, 2022&quot;
  )</code></pre>
<p><img src="web_poisson_files/figure-html/unnamed-chunk-5-1.png" width="90%" height="90%" /></p>
<pre class="r"><code>cancel_airline %&gt;% 
  mutate(year_month = fct_relevel(year_month, &quot;2021-Nov&quot;, &quot;2021-Dec&quot;, &quot;2022-Jan&quot;)) %&gt;% 
  ggplot(aes(x = airline_name, y = Total_number_of_cancellation, fill = year_month)) +
  geom_col(position = &quot;dodge&quot;, alpha = .7) +
  scale_fill_brewer(palette = &quot;Pastel1&quot;) +
  labs(
    x = &quot;Airline&quot;,
    y = &quot;Count by Month&quot;,
    fill = &quot;Year, Month&quot;,
    title = &quot;Flight Cancellations by Month&quot;,
    subtitle = &quot;Nov, 2021 to Jan, 2022&quot;
  )</code></pre>
<p><img src="web_poisson_files/figure-html/unnamed-chunk-5-2.png" width="90%" height="90%" /></p>
<p><br></p>
</div>
<div id="lagging-covid-cases" class="section level3">
<h3>Lagging COVID Cases</h3>
<p>We hypothesized that the time trend of daily flight cancellations and
COVID-19 cases did not coincide with one other. The rises of COVID-19
cases frequently took some time to affect our daily lives, including
flight cancellations. Thus, we created new variables regarding COVID
cases count with time lag.</p>
<pre class="r"><code>cancel_covid = cancel_tidy  %&gt;%
  dplyr::select(date, daily_cancel, covid_case) %&gt;% 
  distinct()

cancel_plot = cancel_covid %&gt;%
  mutate(text_label = str_c(&quot;Date: &quot;, date, &quot;\nCancellation Count: &quot;, daily_cancel)) %&gt;% 
  plot_ly(x = ~date, y = ~daily_cancel, type = &quot;scatter&quot;, mode = &quot;lines+markers&quot;,
          text = ~text_label, alpha = 0.5, hoverinfo = &quot;text&quot;) %&gt;% 
  layout(annotations = list(x = 0.1 , y = 0.8, text = &quot;Daily Flight Cncellations&quot;, showarrow = F,
                            xref = &quot;paper&quot;, yref = &quot;paper&quot;))
         
covid_plot &lt;-  cancel_covid  %&gt;%
  mutate(text_label = str_c(&quot;Date: &quot;, date, &quot;\nCOVID Cases Count: &quot;, covid_case)) %&gt;% 
  plot_ly(
    x = ~date, y = ~covid_case, type = &quot;scatter&quot;, mode = &quot;lines+markers&quot;,
   text = ~text_label, alpha = 0.5, hoverinfo = &quot;text&quot;) %&gt;% 
  layout(annotations = list(x = 0.1 , y = 0.8, text = &quot;Daily COVID Cases&quot;, showarrow = F, 
                            xref = &quot;paper&quot;, yref = &quot;paper&quot;))

scatter_plot &lt;- subplot(cancel_plot, covid_plot, nrows = 2, shareX = TRUE) %&gt;% 
  layout(title = list(text = &quot;Time Trend of Daily Cancellations vs. Daily COVID Cases&quot;),
         xaxis = list(title = &quot;Date&quot;),
         showlegend = FALSE)

scatter_plot</code></pre>
<div id="htmlwidget-4ae1ae24fa1441226bd2" style="width:90%;height:70%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4ae1ae24fa1441226bd2">{"x":{"data":[{"x":["2021-11-01","2021-11-02","2021-11-06","2021-11-07","2021-11-08","2021-11-10","2021-11-11","2021-11-12","2021-11-13","2021-11-15","2021-11-16","2021-11-17","2021-11-18","2021-11-21","2021-11-22","2021-11-25","2021-11-26","2021-11-28","2021-11-29","2021-11-30","2021-12-01","2021-12-07","2021-12-08","2021-12-09","2021-12-10","2021-12-11","2021-12-13","2021-12-14","2021-12-15","2021-12-16","2021-12-18","2021-12-20","2021-12-21","2021-12-22","2021-12-23","2021-12-24","2021-12-25","2021-12-26","2021-12-27","2021-12-28","2021-12-29","2021-12-30","2021-12-31","2022-01-01","2022-01-02","2022-01-03","2022-01-04","2022-01-05","2022-01-06","2022-01-07","2022-01-08","2022-01-09","2022-01-10","2022-01-11","2022-01-12","2022-01-13","2022-01-14","2022-01-15","2022-01-16","2022-01-17","2022-01-18","2022-01-19","2022-01-20","2022-01-21","2022-01-22","2022-01-23","2022-01-24","2022-01-25","2022-01-26","2022-01-27","2022-01-28","2022-01-29","2022-01-30","2022-01-31"],"y":[9,2,2,1,2,6,1,3,5,2,2,2,3,1,1,3,2,1,3,1,2,3,2,2,4,4,3,1,2,2,3,1,2,2,8,19,30,35,27,19,22,38,29,39,54,49,28,6,16,127,11,8,9,5,5,3,2,6,57,15,6,4,17,21,5,3,2,3,2,2,52,333,206,33],"mode":"lines+markers","text":["Date: 2021-11-01<br />Cancellation Count: 9","Date: 2021-11-02<br />Cancellation Count: 2","Date: 2021-11-06<br />Cancellation Count: 2","Date: 2021-11-07<br />Cancellation Count: 1","Date: 2021-11-08<br />Cancellation Count: 2","Date: 2021-11-10<br />Cancellation Count: 6","Date: 2021-11-11<br />Cancellation Count: 1","Date: 2021-11-12<br />Cancellation Count: 3","Date: 2021-11-13<br />Cancellation Count: 5","Date: 2021-11-15<br />Cancellation Count: 2","Date: 2021-11-16<br />Cancellation Count: 2","Date: 2021-11-17<br />Cancellation Count: 2","Date: 2021-11-18<br />Cancellation Count: 3","Date: 2021-11-21<br />Cancellation Count: 1","Date: 2021-11-22<br />Cancellation Count: 1","Date: 2021-11-25<br />Cancellation Count: 3","Date: 2021-11-26<br />Cancellation Count: 2","Date: 2021-11-28<br />Cancellation Count: 1","Date: 2021-11-29<br />Cancellation Count: 3","Date: 2021-11-30<br />Cancellation Count: 1","Date: 2021-12-01<br />Cancellation Count: 2","Date: 2021-12-07<br />Cancellation Count: 3","Date: 2021-12-08<br />Cancellation Count: 2","Date: 2021-12-09<br />Cancellation Count: 2","Date: 2021-12-10<br />Cancellation Count: 4","Date: 2021-12-11<br />Cancellation Count: 4","Date: 2021-12-13<br />Cancellation Count: 3","Date: 2021-12-14<br />Cancellation Count: 1","Date: 2021-12-15<br />Cancellation Count: 2","Date: 2021-12-16<br />Cancellation Count: 2","Date: 2021-12-18<br />Cancellation Count: 3","Date: 2021-12-20<br />Cancellation Count: 1","Date: 2021-12-21<br />Cancellation Count: 2","Date: 2021-12-22<br />Cancellation Count: 2","Date: 2021-12-23<br />Cancellation Count: 8","Date: 2021-12-24<br />Cancellation Count: 19","Date: 2021-12-25<br />Cancellation Count: 30","Date: 2021-12-26<br />Cancellation Count: 35","Date: 2021-12-27<br />Cancellation Count: 27","Date: 2021-12-28<br />Cancellation Count: 19","Date: 2021-12-29<br />Cancellation Count: 22","Date: 2021-12-30<br />Cancellation Count: 38","Date: 2021-12-31<br />Cancellation Count: 29","Date: 2022-01-01<br />Cancellation Count: 39","Date: 2022-01-02<br />Cancellation Count: 54","Date: 2022-01-03<br />Cancellation Count: 49","Date: 2022-01-04<br />Cancellation Count: 28","Date: 2022-01-05<br />Cancellation Count: 6","Date: 2022-01-06<br />Cancellation Count: 16","Date: 2022-01-07<br />Cancellation Count: 127","Date: 2022-01-08<br />Cancellation Count: 11","Date: 2022-01-09<br />Cancellation Count: 8","Date: 2022-01-10<br />Cancellation Count: 9","Date: 2022-01-11<br />Cancellation Count: 5","Date: 2022-01-12<br />Cancellation Count: 5","Date: 2022-01-13<br />Cancellation Count: 3","Date: 2022-01-14<br />Cancellation Count: 2","Date: 2022-01-15<br />Cancellation Count: 6","Date: 2022-01-16<br />Cancellation Count: 57","Date: 2022-01-17<br />Cancellation Count: 15","Date: 2022-01-18<br />Cancellation Count: 6","Date: 2022-01-19<br />Cancellation Count: 4","Date: 2022-01-20<br />Cancellation Count: 17","Date: 2022-01-21<br />Cancellation Count: 21","Date: 2022-01-22<br />Cancellation Count: 5","Date: 2022-01-23<br />Cancellation Count: 3","Date: 2022-01-24<br />Cancellation Count: 2","Date: 2022-01-25<br />Cancellation Count: 3","Date: 2022-01-26<br />Cancellation Count: 2","Date: 2022-01-27<br />Cancellation Count: 2","Date: 2022-01-28<br />Cancellation Count: 52","Date: 2022-01-29<br />Cancellation Count: 333","Date: 2022-01-30<br />Cancellation Count: 206","Date: 2022-01-31<br />Cancellation Count: 33"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(31,119,180,0.498)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,0.498)"},"error_x":{"color":"rgba(31,119,180,0.498)"},"line":{"color":"rgba(31,119,180,0.498)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2021-11-01","2021-11-02","2021-11-06","2021-11-07","2021-11-08","2021-11-10","2021-11-11","2021-11-12","2021-11-13","2021-11-15","2021-11-16","2021-11-17","2021-11-18","2021-11-21","2021-11-22","2021-11-25","2021-11-26","2021-11-28","2021-11-29","2021-11-30","2021-12-01","2021-12-07","2021-12-08","2021-12-09","2021-12-10","2021-12-11","2021-12-13","2021-12-14","2021-12-15","2021-12-16","2021-12-18","2021-12-20","2021-12-21","2021-12-22","2021-12-23","2021-12-24","2021-12-25","2021-12-26","2021-12-27","2021-12-28","2021-12-29","2021-12-30","2021-12-31","2022-01-01","2022-01-02","2022-01-03","2022-01-04","2022-01-05","2022-01-06","2022-01-07","2022-01-08","2022-01-09","2022-01-10","2022-01-11","2022-01-12","2022-01-13","2022-01-14","2022-01-15","2022-01-16","2022-01-17","2022-01-18","2022-01-19","2022-01-20","2022-01-21","2022-01-22","2022-01-23","2022-01-24","2022-01-25","2022-01-26","2022-01-27","2022-01-28","2022-01-29","2022-01-30","2022-01-31"],"y":[780,806,508,542,1135,1049,875,1028,614,1263,1272,1329,1310,840,1528,531,1171,1060,2328,2006,2180,2922,3136,3022,3089,2159,7529,10875,13167,13866,9949,27953,30410,31401,31822,17475,7796,22991,51247,49688,50506,47451,29136,12063,32514,54958,49209,40241,36371,23206,16192,14352,25033,18537,18441,16096,13290,6759,6893,9828,10921,9030,7043,5797,3632,3397,6017,4763,4199,3634,2725,512,1425,3112],"mode":"lines+markers","text":["Date: 2021-11-01<br />COVID Cases Count: 780","Date: 2021-11-02<br />COVID Cases Count: 806","Date: 2021-11-06<br />COVID Cases Count: 508","Date: 2021-11-07<br />COVID Cases Count: 542","Date: 2021-11-08<br />COVID Cases Count: 1135","Date: 2021-11-10<br />COVID Cases Count: 1049","Date: 2021-11-11<br />COVID Cases Count: 875","Date: 2021-11-12<br />COVID Cases Count: 1028","Date: 2021-11-13<br />COVID Cases Count: 614","Date: 2021-11-15<br />COVID Cases Count: 1263","Date: 2021-11-16<br />COVID Cases Count: 1272","Date: 2021-11-17<br />COVID Cases Count: 1329","Date: 2021-11-18<br />COVID Cases Count: 1310","Date: 2021-11-21<br />COVID Cases Count: 840","Date: 2021-11-22<br />COVID Cases Count: 1528","Date: 2021-11-25<br />COVID Cases Count: 531","Date: 2021-11-26<br />COVID Cases Count: 1171","Date: 2021-11-28<br />COVID Cases Count: 1060","Date: 2021-11-29<br />COVID Cases Count: 2328","Date: 2021-11-30<br />COVID Cases Count: 2006","Date: 2021-12-01<br />COVID Cases Count: 2180","Date: 2021-12-07<br />COVID Cases Count: 2922","Date: 2021-12-08<br />COVID Cases Count: 3136","Date: 2021-12-09<br />COVID Cases Count: 3022","Date: 2021-12-10<br />COVID Cases Count: 3089","Date: 2021-12-11<br />COVID Cases Count: 2159","Date: 2021-12-13<br />COVID Cases Count: 7529","Date: 2021-12-14<br />COVID Cases Count: 10875","Date: 2021-12-15<br />COVID Cases Count: 13167","Date: 2021-12-16<br />COVID Cases Count: 13866","Date: 2021-12-18<br />COVID Cases Count: 9949","Date: 2021-12-20<br />COVID Cases Count: 27953","Date: 2021-12-21<br />COVID Cases Count: 30410","Date: 2021-12-22<br />COVID Cases Count: 31401","Date: 2021-12-23<br />COVID Cases Count: 31822","Date: 2021-12-24<br />COVID Cases Count: 17475","Date: 2021-12-25<br />COVID Cases Count: 7796","Date: 2021-12-26<br />COVID Cases Count: 22991","Date: 2021-12-27<br />COVID Cases Count: 51247","Date: 2021-12-28<br />COVID Cases Count: 49688","Date: 2021-12-29<br />COVID Cases Count: 50506","Date: 2021-12-30<br />COVID Cases Count: 47451","Date: 2021-12-31<br />COVID Cases Count: 29136","Date: 2022-01-01<br />COVID Cases Count: 12063","Date: 2022-01-02<br />COVID Cases Count: 32514","Date: 2022-01-03<br />COVID Cases Count: 54958","Date: 2022-01-04<br />COVID Cases Count: 49209","Date: 2022-01-05<br />COVID Cases Count: 40241","Date: 2022-01-06<br />COVID Cases Count: 36371","Date: 2022-01-07<br />COVID Cases Count: 23206","Date: 2022-01-08<br />COVID Cases Count: 16192","Date: 2022-01-09<br />COVID Cases Count: 14352","Date: 2022-01-10<br />COVID Cases Count: 25033","Date: 2022-01-11<br />COVID Cases Count: 18537","Date: 2022-01-12<br />COVID Cases Count: 18441","Date: 2022-01-13<br />COVID Cases Count: 16096","Date: 2022-01-14<br />COVID Cases Count: 13290","Date: 2022-01-15<br />COVID Cases Count: 6759","Date: 2022-01-16<br />COVID Cases Count: 6893","Date: 2022-01-17<br />COVID Cases Count: 9828","Date: 2022-01-18<br />COVID Cases Count: 10921","Date: 2022-01-19<br />COVID Cases Count: 9030","Date: 2022-01-20<br />COVID Cases Count: 7043","Date: 2022-01-21<br />COVID Cases Count: 5797","Date: 2022-01-22<br />COVID Cases Count: 3632","Date: 2022-01-23<br />COVID Cases Count: 3397","Date: 2022-01-24<br />COVID Cases Count: 6017","Date: 2022-01-25<br />COVID Cases Count: 4763","Date: 2022-01-26<br />COVID Cases Count: 4199","Date: 2022-01-27<br />COVID Cases Count: 3634","Date: 2022-01-28<br />COVID Cases Count: 2725","Date: 2022-01-29<br />COVID Cases Count: 512","Date: 2022-01-30<br />COVID Cases Count: 1425","Date: 2022-01-31<br />COVID Cases Count: 3112"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(255,127,14,0.498)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,0.498)"},"error_x":{"color":"rgba(255,127,14,0.498)"},"line":{"color":"rgba(255,127,14,0.498)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"Date","anchor":"y2"},"yaxis2":{"domain":[0,0.48],"automargin":true,"anchor":"x"},"yaxis":{"domain":[0.52,1],"automargin":true,"anchor":"x"},"annotations":[{"x":0.1,"y":0.904,"text":"Daily Flight Cncellations","showarrow":false,"xref":"paper","yref":"paper"},{"x":0.1,"y":0.384,"text":"Daily COVID Cases","showarrow":false,"xref":"paper","yref":"paper"}],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":false,"title":{"text":"Time Trend of Daily Cancellations vs. Daily COVID Cases"}},"attrs":{"2a7555330191":{"x":{},"y":{},"mode":"lines+markers","text":{},"hoverinfo":"text","alpha":0.5,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"2a757ac024a":{"x":{},"y":{},"mode":"lines+markers","text":{},"hoverinfo":"text","alpha":0.5,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>We used the lag selection criteria and Akaike information criterion
(AIC) to select 6 days as the optimal time lag. Then, we constructed a
new variable named <code>covid_lag6</code>, equivalent to the value of
COVID-19 cases with a 6-day time lag.</p>
<p><br></p>
</div>
</div>
<div id="poisson-regression-model" class="section level2">
<h2>Poisson Regression Model</h2>
<p><br></p>
<p><img src="pictures/poisson_model.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>poisson = glm(daily_cancel ~ temperature + humidity + windspeed + covid_lag6, 
              family = &quot;poisson&quot;,
              data = cancel_tidy)

poisson %&gt;% 
  broom::tidy() %&gt;% 
  mutate(OR = exp(estimate),
    p.value = format(p.value, scientific = TRUE, digits = 3)
  ) %&gt;% 
  dplyr::select(term, estimate, OR, p.value) %&gt;% 
  knitr::kable(digits = 3, col.names = c(&quot;Terms&quot;, &quot;Estimate (log(OR))&quot;, &quot;Estimated adjusted OR&quot;, &quot;P-value&quot;)) %&gt;% 
  kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Terms
</th>
<th style="text-align:right;">
Estimate (log(OR))
</th>
<th style="text-align:right;">
Estimated adjusted OR
</th>
<th style="text-align:left;">
P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
2.443
</td>
<td style="text-align:right;">
11.509
</td>
<td style="text-align:left;">
1.41e-195
</td>
</tr>
<tr>
<td style="text-align:left;">
temperature
</td>
<td style="text-align:right;">
-0.119
</td>
<td style="text-align:right;">
0.888
</td>
<td style="text-align:left;">
0.00e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
humidity
</td>
<td style="text-align:right;">
0.057
</td>
<td style="text-align:right;">
1.059
</td>
<td style="text-align:left;">
0.00e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
windspeed
</td>
<td style="text-align:right;">
0.036
</td>
<td style="text-align:right;">
1.036
</td>
<td style="text-align:left;">
2.27e-154
</td>
</tr>
<tr>
<td style="text-align:left;">
covid_lag6
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:left;">
2.37e-05
</td>
</tr>
</tbody>
</table>
<p>The above is the outcome of Poisson regression. All predictor
coefficients are statistically significant (associated with a p-value of
0.05), indicating that temperature, humidity, windspeed, and COVID-19
cases indeed impact the rate of daily flight cancellation.</p>
<p>Exponentiating the Poisson regression coefficient provides the
incidence rate ratio of daily flight cancellation. Take
<code>temperature</code> as an example; its parameter estimate is
-0.119, which means that increasing the temperature by one degree
Fahrenheit should decrease the difference in the logs of predicted daily
flight cancellations by 0.119 occurrences while holding the other
variables in the model constant.</p>
<p>We obtained an estimated adjusted OR after exponentiating all of the
coefficients. Again, take <code>temperature</code> as an example: a
one-degree Fahrenheit increase in temperature is expected to reduce the
estimated rate ratio of daily flight cancellations by a factor of 0.888
while holding all other variables constant in the model.</p>
<p><br></p>
<div id="stratified-by-month" class="section level3">
<h3>Stratified by Month</h3>
<pre class="r"><code>cancel_tidy %&gt;% 
  nest(df = -month) %&gt;%
  mutate(
    models = map(.x = df, ~ glm(daily_cancel ~ temperature + humidity + windspeed + covid_lag6,family = &quot;poisson&quot;, data = .x)),
    results = map(models, broom::tidy)
  ) %&gt;% 
  unnest(results) %&gt;% 
  dplyr::select(month, term, estimate) %&gt;% 
  mutate(term = fct_inorder(term)) %&gt;% 
  pivot_wider(
    names_from = term, 
    values_from = estimate) %&gt;% 
  knitr::kable(digits = 6) %&gt;% 
  kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
month
</th>
<th style="text-align:right;">
(Intercept)
</th>
<th style="text-align:right;">
temperature
</th>
<th style="text-align:right;">
humidity
</th>
<th style="text-align:right;">
windspeed
</th>
<th style="text-align:right;">
covid_lag6
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
November
</td>
<td style="text-align:right;">
-0.289407
</td>
<td style="text-align:right;">
0.050352
</td>
<td style="text-align:right;">
-0.033685
</td>
<td style="text-align:right;">
0.029304
</td>
<td style="text-align:right;">
3.3e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
December
</td>
<td style="text-align:right;">
0.136457
</td>
<td style="text-align:right;">
-0.012493
</td>
<td style="text-align:right;">
0.015354
</td>
<td style="text-align:right;">
0.053751
</td>
<td style="text-align:right;">
3.2e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
January
</td>
<td style="text-align:right;">
2.570463
</td>
<td style="text-align:right;">
-0.122494
</td>
<td style="text-align:right;">
0.060112
</td>
<td style="text-align:right;">
0.031507
</td>
<td style="text-align:right;">
0.0e+00
</td>
</tr>
</tbody>
</table>
<p><br></p>
<div id="or-and-95-ci" class="section level4">
<h4>OR and 95% CI</h4>
<p>Overview of estimated OR, 95% CI and P-value.</p>
<pre class="r"><code>poisson_by_month = cancel_tidy %&gt;%
  nest(data = -month) %&gt;% 
  mutate(
    models = map(.x = data, ~glm(daily_cancel ~ temperature + humidity + windspeed + covid_lag6, family = &quot;poisson&quot;, data = .x)),
    results = map(models, broom::tidy)
    ) %&gt;% 
  dplyr::select(month, results) %&gt;% 
  unnest(results) %&gt;% 
  mutate(
    OR = exp(estimate),
    CI_lower = exp(estimate - 1.96 * std.error),
    CI_upper = exp(estimate + 1.96 * std.error),
    p.value = format(p.value, scientific = TRUE, digits = 3)
  ) %&gt;% 
  dplyr::select(month, term, OR, CI_lower,CI_upper, p.value) 

poisson_by_month %&gt;% 
  filter(term != &quot;(Intercept)&quot; ) %&gt;% 
  knitr::kable(digits = 3, align = &quot;llccc&quot;, col.names = c(&quot;Month&quot;, &quot;Terms&quot;, &quot;Estimated adjusted OR&quot;, &quot;CI lower bound&quot;, &quot;CI upper bound&quot;, &quot;P-value&quot;)) %&gt;% 
  kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Month
</th>
<th style="text-align:left;">
Terms
</th>
<th style="text-align:center;">
Estimated adjusted OR
</th>
<th style="text-align:center;">
CI lower bound
</th>
<th style="text-align:center;">
CI upper bound
</th>
<th style="text-align:left;">
P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
November
</td>
<td style="text-align:left;">
temperature
</td>
<td style="text-align:center;">
1.052
</td>
<td style="text-align:center;">
1.006
</td>
<td style="text-align:center;">
1.099
</td>
<td style="text-align:left;">
2.60e-02
</td>
</tr>
<tr>
<td style="text-align:left;">
November
</td>
<td style="text-align:left;">
humidity
</td>
<td style="text-align:center;">
0.967
</td>
<td style="text-align:center;">
0.940
</td>
<td style="text-align:center;">
0.995
</td>
<td style="text-align:left;">
2.12e-02
</td>
</tr>
<tr>
<td style="text-align:left;">
November
</td>
<td style="text-align:left;">
windspeed
</td>
<td style="text-align:center;">
1.030
</td>
<td style="text-align:center;">
0.996
</td>
<td style="text-align:center;">
1.064
</td>
<td style="text-align:left;">
8.25e-02
</td>
</tr>
<tr>
<td style="text-align:left;">
November
</td>
<td style="text-align:left;">
covid_lag6
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
0.999
</td>
<td style="text-align:center;">
1.001
</td>
<td style="text-align:left;">
9.52e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
December
</td>
<td style="text-align:left;">
temperature
</td>
<td style="text-align:center;">
0.988
</td>
<td style="text-align:center;">
0.970
</td>
<td style="text-align:center;">
1.006
</td>
<td style="text-align:left;">
1.79e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
December
</td>
<td style="text-align:left;">
humidity
</td>
<td style="text-align:center;">
1.015
</td>
<td style="text-align:center;">
1.007
</td>
<td style="text-align:center;">
1.024
</td>
<td style="text-align:left;">
1.62e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
December
</td>
<td style="text-align:left;">
windspeed
</td>
<td style="text-align:center;">
1.055
</td>
<td style="text-align:center;">
1.039
</td>
<td style="text-align:center;">
1.071
</td>
<td style="text-align:left;">
5.33e-12
</td>
</tr>
<tr>
<td style="text-align:left;">
December
</td>
<td style="text-align:left;">
covid_lag6
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:left;">
2.51e-33
</td>
</tr>
<tr>
<td style="text-align:left;">
January
</td>
<td style="text-align:left;">
temperature
</td>
<td style="text-align:center;">
0.885
</td>
<td style="text-align:center;">
0.881
</td>
<td style="text-align:center;">
0.889
</td>
<td style="text-align:left;">
0.00e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
January
</td>
<td style="text-align:left;">
humidity
</td>
<td style="text-align:center;">
1.062
</td>
<td style="text-align:center;">
1.059
</td>
<td style="text-align:center;">
1.065
</td>
<td style="text-align:left;">
0.00e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
January
</td>
<td style="text-align:left;">
windspeed
</td>
<td style="text-align:center;">
1.032
</td>
<td style="text-align:center;">
1.029
</td>
<td style="text-align:center;">
1.035
</td>
<td style="text-align:left;">
4.06e-92
</td>
</tr>
<tr>
<td style="text-align:left;">
January
</td>
<td style="text-align:left;">
covid_lag6
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:left;">
8.81e-01
</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div id="plot" class="section level4">
<h4>Plot</h4>
<pre class="r"><code>poisson_by_month %&gt;%
  filter(term != &quot;(Intercept)&quot;) %&gt;%
  mutate(month = fct_relevel(month, &quot;November&quot;, &quot;December&quot;, &quot;January&quot;)) %&gt;% 
  ggplot(aes(x = month, y = OR, color = term)) + 
  geom_point(show.legend = FALSE, aes()) +
  geom_errorbar(aes(ymin = CI_lower, 
                    ymax = CI_upper)) +
  labs(
    title = &quot;Estimated OR with 95% CI in Daily Flight Cancellation by Month&quot;,
    x = &quot;Month&quot;,
    y = &quot;Estimated OR with CI&quot;
  ) +
  theme(legend.position = &quot;right&quot;, legend.title = element_blank(),
        text = element_text(size = 10),
        axis.text.x = element_text(angle = 60, hjust = 1, size = 8)) + 
  facet_grid(. ~ term)</code></pre>
<p><img src="web_poisson_files/figure-html/unnamed-chunk-12-1.png" width="90%" /></p>
<p><br></p>
</div>
</div>
<div id="stratified-by-airline" class="section level3">
<h3>Stratified by Airline</h3>
<pre class="r"><code>cancel_tidy %&gt;% 
  nest(df = -airline_name) %&gt;%
  mutate(
    models = map(.x = df, ~ glm(daily_cancel ~ temperature + humidity + windspeed + covid_lag6,family = &quot;poisson&quot;, data = .x)),
    results = map(models, broom::tidy)
  ) %&gt;% 
  unnest(results) %&gt;% 
  dplyr::select(airline_name, term, estimate) %&gt;% 
  mutate(term = fct_inorder(term)) %&gt;% 
  pivot_wider(
    names_from = term, 
    values_from = estimate) %&gt;% 
  knitr::kable(digits = 6) %&gt;% 
  kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
airline_name
</th>
<th style="text-align:right;">
(Intercept)
</th>
<th style="text-align:right;">
temperature
</th>
<th style="text-align:right;">
humidity
</th>
<th style="text-align:right;">
windspeed
</th>
<th style="text-align:right;">
covid_lag6
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
American Airlines
</td>
<td style="text-align:right;">
1.377950
</td>
<td style="text-align:right;">
-0.119697
</td>
<td style="text-align:right;">
0.063910
</td>
<td style="text-align:right;">
0.048125
</td>
<td style="text-align:right;">
8e-06
</td>
</tr>
<tr>
<td style="text-align:left;">
Alaska Airlines
</td>
<td style="text-align:right;">
3.116599
</td>
<td style="text-align:right;">
-0.110591
</td>
<td style="text-align:right;">
0.045749
</td>
<td style="text-align:right;">
0.035340
</td>
<td style="text-align:right;">
3e-06
</td>
</tr>
<tr>
<td style="text-align:left;">
JetBlue Airways
</td>
<td style="text-align:right;">
1.987016
</td>
<td style="text-align:right;">
-0.130157
</td>
<td style="text-align:right;">
0.068785
</td>
<td style="text-align:right;">
0.031199
</td>
<td style="text-align:right;">
4e-06
</td>
</tr>
<tr>
<td style="text-align:left;">
Delta Air Lines
</td>
<td style="text-align:right;">
3.122657
</td>
<td style="text-align:right;">
-0.101793
</td>
<td style="text-align:right;">
0.044541
</td>
<td style="text-align:right;">
0.032940
</td>
<td style="text-align:right;">
-4e-06
</td>
</tr>
<tr>
<td style="text-align:left;">
Endeavor Air
</td>
<td style="text-align:right;">
2.736109
</td>
<td style="text-align:right;">
-0.133060
</td>
<td style="text-align:right;">
0.071020
</td>
<td style="text-align:right;">
0.015299
</td>
<td style="text-align:right;">
5e-06
</td>
</tr>
<tr>
<td style="text-align:left;">
Republic Airways
</td>
<td style="text-align:right;">
2.102555
</td>
<td style="text-align:right;">
-0.128872
</td>
<td style="text-align:right;">
0.059484
</td>
<td style="text-align:right;">
0.046475
</td>
<td style="text-align:right;">
9e-06
</td>
</tr>
<tr>
<td style="text-align:left;">
United Air Lines
</td>
<td style="text-align:right;">
3.431154
</td>
<td style="text-align:right;">
-0.077203
</td>
<td style="text-align:right;">
0.029393
</td>
<td style="text-align:right;">
0.042199
</td>
<td style="text-align:right;">
-5e-06
</td>
</tr>
</tbody>
</table>
<p><br></p>
<div id="or-and-95-ci-1" class="section level4">
<h4>OR and 95% CI</h4>
<pre class="r"><code>poisson_by_airline = cancel_tidy %&gt;%
  nest(data = -airline_name) %&gt;% 
  mutate(
    models = map(.x = data, ~glm(daily_cancel ~ temperature + humidity + windspeed + covid_lag6, family = &quot;poisson&quot;, data = .x)),
    results = map(models, broom::tidy)
    ) %&gt;% 
  dplyr::select(airline_name, results) %&gt;% 
  unnest(results) %&gt;% 
  mutate(
    OR = exp(estimate),
    CI_lower = exp(estimate - 1.96 * std.error),
    CI_upper = exp(estimate + 1.96 * std.error),
    p.value = format(p.value, scientific = TRUE, digits = 3)
  ) %&gt;% 
  dplyr::select(airline_name, term, OR, CI_lower,CI_upper, p.value) 

poisson_by_airline %&gt;% 
  filter(term != &quot;(Intercept)&quot; ) %&gt;% 
  knitr::kable(digits = 3, 
               align = &quot;llccc&quot;, 
               col.names = c(&quot;Airline Name&quot;, &quot;Terms&quot;, &quot;Estimated adjusted OR&quot;, &quot;CI lower bound&quot;, &quot;CI upper bound&quot;, &quot;P-value&quot;)) %&gt;% 
  kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Airline Name
</th>
<th style="text-align:left;">
Terms
</th>
<th style="text-align:center;">
Estimated adjusted OR
</th>
<th style="text-align:center;">
CI lower bound
</th>
<th style="text-align:center;">
CI upper bound
</th>
<th style="text-align:left;">
P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
American Airlines
</td>
<td style="text-align:left;">
temperature
</td>
<td style="text-align:center;">
0.887
</td>
<td style="text-align:center;">
0.880
</td>
<td style="text-align:center;">
0.894
</td>
<td style="text-align:left;">
1.14e-196
</td>
</tr>
<tr>
<td style="text-align:left;">
American Airlines
</td>
<td style="text-align:left;">
humidity
</td>
<td style="text-align:center;">
1.066
</td>
<td style="text-align:center;">
1.061
</td>
<td style="text-align:center;">
1.071
</td>
<td style="text-align:left;">
1.17e-131
</td>
</tr>
<tr>
<td style="text-align:left;">
American Airlines
</td>
<td style="text-align:left;">
windspeed
</td>
<td style="text-align:center;">
1.049
</td>
<td style="text-align:center;">
1.042
</td>
<td style="text-align:center;">
1.056
</td>
<td style="text-align:left;">
1.09e-46
</td>
</tr>
<tr>
<td style="text-align:left;">
American Airlines
</td>
<td style="text-align:left;">
covid_lag6
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:left;">
1.43e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
Alaska Airlines
</td>
<td style="text-align:left;">
temperature
</td>
<td style="text-align:center;">
0.895
</td>
<td style="text-align:center;">
0.888
</td>
<td style="text-align:center;">
0.903
</td>
<td style="text-align:left;">
5.56e-139
</td>
</tr>
<tr>
<td style="text-align:left;">
Alaska Airlines
</td>
<td style="text-align:left;">
humidity
</td>
<td style="text-align:center;">
1.047
</td>
<td style="text-align:center;">
1.041
</td>
<td style="text-align:center;">
1.053
</td>
<td style="text-align:left;">
4.36e-57
</td>
</tr>
<tr>
<td style="text-align:left;">
Alaska Airlines
</td>
<td style="text-align:left;">
windspeed
</td>
<td style="text-align:center;">
1.036
</td>
<td style="text-align:center;">
1.028
</td>
<td style="text-align:center;">
1.044
</td>
<td style="text-align:left;">
2.99e-19
</td>
</tr>
<tr>
<td style="text-align:left;">
Alaska Airlines
</td>
<td style="text-align:left;">
covid_lag6
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:left;">
2.13e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
JetBlue Airways
</td>
<td style="text-align:left;">
temperature
</td>
<td style="text-align:center;">
0.878
</td>
<td style="text-align:center;">
0.871
</td>
<td style="text-align:center;">
0.885
</td>
<td style="text-align:left;">
2.37e-212
</td>
</tr>
<tr>
<td style="text-align:left;">
JetBlue Airways
</td>
<td style="text-align:left;">
humidity
</td>
<td style="text-align:center;">
1.071
</td>
<td style="text-align:center;">
1.066
</td>
<td style="text-align:center;">
1.076
</td>
<td style="text-align:left;">
5.54e-170
</td>
</tr>
<tr>
<td style="text-align:left;">
JetBlue Airways
</td>
<td style="text-align:left;">
windspeed
</td>
<td style="text-align:center;">
1.032
</td>
<td style="text-align:center;">
1.025
</td>
<td style="text-align:center;">
1.038
</td>
<td style="text-align:left;">
4.61e-23
</td>
</tr>
<tr>
<td style="text-align:left;">
JetBlue Airways
</td>
<td style="text-align:left;">
covid_lag6
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:left;">
6.23e-02
</td>
</tr>
<tr>
<td style="text-align:left;">
Delta Air Lines
</td>
<td style="text-align:left;">
temperature
</td>
<td style="text-align:center;">
0.903
</td>
<td style="text-align:center;">
0.894
</td>
<td style="text-align:center;">
0.912
</td>
<td style="text-align:left;">
1.62e-85
</td>
</tr>
<tr>
<td style="text-align:left;">
Delta Air Lines
</td>
<td style="text-align:left;">
humidity
</td>
<td style="text-align:center;">
1.046
</td>
<td style="text-align:center;">
1.040
</td>
<td style="text-align:center;">
1.051
</td>
<td style="text-align:left;">
2.11e-67
</td>
</tr>
<tr>
<td style="text-align:left;">
Delta Air Lines
</td>
<td style="text-align:left;">
windspeed
</td>
<td style="text-align:center;">
1.033
</td>
<td style="text-align:center;">
1.027
</td>
<td style="text-align:center;">
1.041
</td>
<td style="text-align:left;">
1.48e-21
</td>
</tr>
<tr>
<td style="text-align:left;">
Delta Air Lines
</td>
<td style="text-align:left;">
covid_lag6
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:left;">
8.70e-02
</td>
</tr>
<tr>
<td style="text-align:left;">
Endeavor Air
</td>
<td style="text-align:left;">
temperature
</td>
<td style="text-align:center;">
0.875
</td>
<td style="text-align:center;">
0.866
</td>
<td style="text-align:center;">
0.885
</td>
<td style="text-align:left;">
1.55e-125
</td>
</tr>
<tr>
<td style="text-align:left;">
Endeavor Air
</td>
<td style="text-align:left;">
humidity
</td>
<td style="text-align:center;">
1.074
</td>
<td style="text-align:center;">
1.066
</td>
<td style="text-align:center;">
1.081
</td>
<td style="text-align:left;">
9.53e-85
</td>
</tr>
<tr>
<td style="text-align:left;">
Endeavor Air
</td>
<td style="text-align:left;">
windspeed
</td>
<td style="text-align:center;">
1.015
</td>
<td style="text-align:center;">
1.007
</td>
<td style="text-align:center;">
1.024
</td>
<td style="text-align:left;">
1.66e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
Endeavor Air
</td>
<td style="text-align:left;">
covid_lag6
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:left;">
3.45e-02
</td>
</tr>
<tr>
<td style="text-align:left;">
Republic Airways
</td>
<td style="text-align:left;">
temperature
</td>
<td style="text-align:center;">
0.879
</td>
<td style="text-align:center;">
0.871
</td>
<td style="text-align:center;">
0.888
</td>
<td style="text-align:left;">
4.60e-146
</td>
</tr>
<tr>
<td style="text-align:left;">
Republic Airways
</td>
<td style="text-align:left;">
humidity
</td>
<td style="text-align:center;">
1.061
</td>
<td style="text-align:center;">
1.055
</td>
<td style="text-align:center;">
1.068
</td>
<td style="text-align:left;">
1.80e-77
</td>
</tr>
<tr>
<td style="text-align:left;">
Republic Airways
</td>
<td style="text-align:left;">
windspeed
</td>
<td style="text-align:center;">
1.048
</td>
<td style="text-align:center;">
1.040
</td>
<td style="text-align:center;">
1.055
</td>
<td style="text-align:left;">
1.55e-38
</td>
</tr>
<tr>
<td style="text-align:left;">
Republic Airways
</td>
<td style="text-align:left;">
covid_lag6
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:left;">
9.78e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
United Air Lines
</td>
<td style="text-align:left;">
temperature
</td>
<td style="text-align:center;">
0.926
</td>
<td style="text-align:center;">
0.913
</td>
<td style="text-align:center;">
0.938
</td>
<td style="text-align:left;">
4.56e-29
</td>
</tr>
<tr>
<td style="text-align:left;">
United Air Lines
</td>
<td style="text-align:left;">
humidity
</td>
<td style="text-align:center;">
1.030
</td>
<td style="text-align:center;">
1.024
</td>
<td style="text-align:center;">
1.036
</td>
<td style="text-align:left;">
3.03e-21
</td>
</tr>
<tr>
<td style="text-align:left;">
United Air Lines
</td>
<td style="text-align:left;">
windspeed
</td>
<td style="text-align:center;">
1.043
</td>
<td style="text-align:center;">
1.030
</td>
<td style="text-align:center;">
1.056
</td>
<td style="text-align:left;">
6.75e-11
</td>
</tr>
<tr>
<td style="text-align:left;">
United Air Lines
</td>
<td style="text-align:left;">
covid_lag6
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:left;">
4.94e-02
</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div id="plot-1" class="section level4">
<h4>Plot</h4>
<pre class="r"><code>poisson_by_airline %&gt;%
  filter(term != &quot;(Intercept)&quot;) %&gt;%
  ggplot(aes(x = airline_name, y = OR, color = term)) + 
  geom_point(show.legend = FALSE, aes()) +
  geom_errorbar(aes(ymin = CI_lower, 
                    ymax = CI_upper)) +
  labs(
    title = &quot;Estimated OR with 95% CI in Daily Flight Cancellation by Airline&quot;,
    x = &quot;Airline&quot;,
    y = &quot;Estimated OR with CI&quot;
  ) +
  theme(legend.position = &quot;right&quot;, legend.title = element_blank(),
        text = element_text(size = 10),
        axis.text.x = element_text(angle = 60, hjust = 1, size = 8)) + 
  facet_grid(. ~ term)</code></pre>
<p><img src="web_poisson_files/figure-html/unnamed-chunk-15-1.png" width="90%" /></p>
<p><br></p>
</div>
</div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>Our Poisson regression model indicates that all our main effects
(weather-related factors and COVID-19 cases) are statistically
significant, as we proposed. Since the data exploration and pre-analysis
indicated that there indeed are differences by month and airline, we
then stratified our Poisson model by these two factors. An interesting
finding is that although the regression output shows that daily COVID-19
cases have a statistically significant effect on daily flight
cancellation, after stratified by month and airline, there is no obvious
trend between daily COVID-19 cases and daily flight cancellation based
on graph.</p>
<p><br></p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>We hypothesized that just two factors, adverse weather and COVID-19
cases, affect daily flight cancellations. I More elements that might
influence real-life cancellation were not considered. As a result, we
should note the constraint that this cancellation data does not include
cancellations due to other factors, such as air traffic limitations.
This restricted the information we could obtain from the cancellation
dataset, preventing us from adjusting for variables we suspected were
confounding the correlations.</p>
<p>What’s more, the association between COVID-19 cases and daily flight
cancellations was not as strong as we expected. One reason might be that
the research window was too short to discover the association because
COVID-19 cases had a time lag and we only counted 3-month cancellations
and COVID-19 cases.</p>
<div class="tocify-extend-page" data-unique="tocify-extend-page"
style="height: 0;">

</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
