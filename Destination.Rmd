---
title: "Destination Airport"
output: html_document
runtime: shiny
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(plotly)
library(shiny)

delay = read_csv("tidied_data/delay.csv")
cancel = read_csv("tidied_data/cancel.csv")
```

```{r, echo = FALSE}
airlines = delay %>% distinct(airline_name) %>% pull()

selectInput(
  inputId = "airline_choice",
  label = h3("Airline"),
  choices = airlines,
  selected = "JetBlue Airways"
)
```

### Distribution of Delay 
```{r, echo = FALSE}
renderPlotly({
  delay %>%
    filter(
      airline_name == input[["airline_choice"]]
    ) %>% 
    group_by(destination_airport) %>% 
    mutate(
      count = n()
      ) %>% 
  ungroup() %>% 
  mutate(
    destination_airport = fct_reorder(destination_airport, count),
    text_label = str_c("Airpline: ", airline_name, "\nCount: ", count)
      ) %>% 
  plot_ly(x = ~destination_airport, hoverinfo = "text", 
          color = "rgb(255, 65, 54)", type = "histogram", alpha = .5) %>% 
  layout(
    xaxis = list(title = "Destination Airport"),
    yaxis = list(title = "Count"))

})
```

### Distribution of Cancelation
```{r, echo = FALSE}
renderPlotly({
  cancel %>%
    filter(
      airline_name == input[["airline_choice"]]
    ) %>% 
    group_by(destination_airport) %>% 
    mutate(
      count = n()
      ) %>% 
  ungroup() %>% 
  mutate(
    destination_airport = fct_reorder(destination_airport, count),
    text_label = str_c("Airpline: ", airline_name, "\nCount: ", count)
      ) %>% 
  plot_ly(x = ~destination_airport, text = ~count, name = "",
          hovertemplate = paste("%{x}", "<br>Count: %{text:.2s}<br>"),
          texttemplate = "%{y:.2s}",
          color = "rgb(255, 65, 54)", type = "histogram", alpha = .5) %>% 
  layout(
    xaxis = list(title = "Destination Airport"),
    yaxis = list(title = "Count"))

})
```

