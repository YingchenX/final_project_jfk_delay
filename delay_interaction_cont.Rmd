---
title: "Delay Data Exploration for Continuous Predictors"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE,
                      message = FALSE)

library(tidyverse)
library(plotly)


raw_df = read_csv("Reg_data_exp/raw_for_exp.csv")
```

<br>

**We would like to conduct a linear regression on delay time in minutes. In this case, we would need to check if the interactions between some continuous predictors and airlines, months, periods of time, respectively, were significantly associated with the total delay time in minutes. To achieve it, we did some visualizations.**

The continuous predictors included:

*   **Types of Delay** (in minutes; five categories in total, determined by the U.S. Department of Transportation, reported by [the Bureau of Transportation](https://www.bts.gov/explore-topics-and-geography/topics/airline-time-performance-and-causes-flight-delays))

    *   Carrier Delay: The cause of the cancellation or delay was due to circumstances within the airline's control (e.g. maintenance or crew problems, aircraft cleaning, baggage loading, fueling, etc.)
  
    *   Extreme Weather Delay: Significant meteorological conditions (actual or forecasted) that, in the judgment of the carrier, delays or prevents the operation of a flight such as tornado, blizzard or hurricane
  
    *   Late Arrival Delay: A previous flight with same aircraft arrived late, causing the present flight to depart late
  
    *   National Aviation System (NAS) Delay: Delays and cancellations attributable to the national aviation system that refer to a broad set of conditions, such as non-extreme weather conditions, airport operations, heavy traffic volume, and air traffic control
  
    *   Security Delay: Delays or cancellations caused by evacuation of a terminal or concourse, re-boarding of aircraft because of security breach, inoperative screening equipment and/or long lines in excess of 29 minutes at screening areas  

*   **Weather Specific**

    *   Temperature: Hourly dry bulb temperature (째F)
    
    *   Humidity: Hourly relative humidity (%)
    
    *   Visibility: Hourly visibility
    
    *   Wind Speed: Hourly wind speed (mph)

<br>

```{r}
cont_airline = function(cont){
  
  airline = raw_df %>% 
  plot_ly(x = ~cont, y = ~delay, color = ~airline,
          type = "scatter", mode = "markers", alpha = .5) %>% 
  layout(yaxis = list(title = "Delay Time (minutes)"))
}

cont_month = function(cont){
  month = raw_df %>%
    mutate(month = fct_reorder(month, date)) %>% 
  plot_ly(x = ~cont, y = ~delay, color = ~month,
          type = "scatter", mode = "markers", alpha = .5) %>% 
  layout(yaxis = list(title = "Delay Time (minutes)"))
}
  
cont_hour = function(cont){
  hour = raw_df %>% 
  plot_ly(x = ~cont, y = ~delay, color = ~hour_c,
          type = "scatter", mode = "markers", alpha = .5) %>% 
  layout(yaxis = list(title = "Delay Time (minutes)"))
}

```


## Interaction for Continuous Predictors 

<br>

### Types of Delay{.tabset}

#### Carrier Delay

```{r, echo = FALSE}
cont_airline(raw_df$carrierd) %>% 
  layout(xaxis = list(title = "Carrier Delay (minutes)"))

cont_month(raw_df$carrierd) %>% 
  layout(xaxis = list(title = "Carrier Delay (minutes)"))

cont_hour(raw_df$carrierd) %>% 
  layout(xaxis = list(title = "Carrier Delay (minutes)"))

```

#### Extreme Weather Delay

```{r, echo = FALSE}
cont_airline(raw_df$extrmwd) %>% 
  layout(xaxis = list(title = "Extreme Weather Delay (minutes)"))

cont_month(raw_df$extrmwd) %>% 
  layout(xaxis = list(title = "Extreme Weather Delay (minutes)"))

cont_hour(raw_df$extrmwd) %>% 
  layout(xaxis = list(title = "Extreme Weather Delay (minutes)"))
```

#### Late Arrival Delay

```{r, echo = FALSE}
cont_airline(raw_df$latarrd) %>% 
  layout(xaxis = list(title = "Late Arrival Delay (minutes)"))

cont_month(raw_df$latarrd) %>% 
  layout(xaxis = list(title = "Late Arrival Delay (minutes)"))

cont_hour(raw_df$latarrd) %>% 
  layout(xaxis = list(title = "Late Arrival Delay (minutes)"))
```

#### NAS Delay

```{r, echo = FALSE}
cont_airline(raw_df$nasd) %>% 
  layout(xaxis = list(title = "NAS Delay (minutes)"))

cont_month(raw_df$nasd) %>% 
  layout(xaxis = list(title = "NAS Delay (minutes)"))

cont_hour(raw_df$nasd) %>% 
  layout(xaxis = list(title = "NAS Delay (minutes)"))
```

#### Security Delay

```{r, echo = FALSE}
cont_airline(raw_df$securityd) %>% 
  layout(xaxis = list(title = "Security Delay (minutes)"))

cont_month(raw_df$securityd) %>% 
  layout(xaxis = list(title = "Security Delay (minutes)"))

cont_hour(raw_df$securityd) %>% 
  layout(xaxis = list(title = "Security Delay (minutes)"))
```


### Weather Specific{.tabset}

#### Temperature

```{r, echo = FALSE}
cont_airline(raw_df$temperature) %>% 
  layout(xaxis = list(title = "Temperature (째F)"))

cont_month(raw_df$temperature) %>% 
  layout(xaxis = list(title = "Temperature (째F)"))

cont_hour(raw_df$temperature) %>% 
  layout(xaxis = list(title = "Temperature (째F)"))
```

#### Humidity

```{r, echo = FALSE}
cont_airline(raw_df$humidity) %>% 
  layout(xaxis = list(title = "Humidity (%)"))

cont_month(raw_df$humidity) %>% 
  layout(xaxis = list(title = "Humidity (%)"))

cont_hour(raw_df$humidity) %>% 
  layout(xaxis = list(title = "Humidity (%)"))
```

#### Visibility

```{r, echo = FALSE}
cont_airline(raw_df$visibility) %>% 
  layout(xaxis = list(title = "Visibility"))

cont_month(raw_df$visibility) %>% 
  layout(xaxis = list(title = "Visibility"))

cont_hour(raw_df$visibility) %>% 
  layout(xaxis = list(title = "Visibility"))
```

#### Wind Speed

```{r, echo = FALSE}
cont_airline(raw_df$wind_s) %>% 
  layout(xaxis = list(title = "Wind Speed (mph)"))

cont_month(raw_df$wind_s) %>% 
  layout(xaxis = list(title = "Wind Speed (mph)"))

cont_hour(raw_df$wind_s) %>% 
  layout(xaxis = list(title = "Wind Speed (mph)"))
```

###

<br>

Based on the graphs, we found that there could be significant interactions between:

1.    Carrier Delay * Airline

2.    Temperature * Month

As a result, we would like to focus on these interaction terms in addition to other predictors.
